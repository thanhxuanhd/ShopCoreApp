var productController=function(){var i=function(){r();n();t()},t=function(){$("#ddlShowPage").on("change",function(){app.configs.pageSize=$(this).val();app.configs.pageIndex=1;n(!0)});$("#btnSearch").on("click",function(){n()});$("#txtKeyword").on("keypress",function(t){t.which===13&&n()})},r=function(){$.ajax({type:"GET",url:"/admin/product/GetAllCategory",dataType:"json",success:function(n){if(n){var t='<option value="">--Select category--<\/option>';$.each(n,function(n,i){t+='<option value="'+i.Id+'">'+i.Name+"<\/option>"});$("#ddlCategorySearch").html(t)}},error:function(n){console.log(n);app.notify("Cannot loading data","error")}})},n=function(t){var r=$("#table-template").html(),i="";$.ajax({type:"GET",url:"/admin/product/GetAllPaging",dataType:"json",data:{categoryId:$("#ddlCategorySearch").val(),keyword:$("#txtKeyword").val(),pageSize:app.configs.pageSize,page:app.configs.pageIndex},success:function(f){f&&f.Result&&$.each(f.Result,function(e,o){i+=Mustache.render(r,{Id:o.Id,Name:o.Name,CategoryName:o.ProductCategory.Name,Image:o.Image===null?'<img scr="/admin/images/user.png" width=25>':'<img scr="'+o.Image+'" width=25>',CreatedDate:app.dateFormatJson(o.DateCreated),Status:app.getStatus(o.Status),Price:app.formatNumber(o.Price)});$("#lblTotalRecords").text(f.RowCount);i!==""&&$("#tblContent").html(i);u(f.RowCount,function(){n()},t)})},error:function(n){console.log(n);app.notify("Cannot loading data","error")}})},u=function(n,t,i){var r=Math.ceil(n/app.configs.pageSize);($("#paginationUL a").length===0||i===!0)&&($("#paginationUL").empty(),$("#paginationUL").removeData("twbs-pagination"),$("#paginationUL").unbind("page"));$("#paginationUL").twbsPagination({totalPages:r,visiablePages:7,first:"First",prev:"Prev",next:"Next",last:"Last",onPageClick:function(n,i){app.configs.pageIndex=i;setTimeout(t(),200)}})};return{initailize:i,registerEvent:t}}();