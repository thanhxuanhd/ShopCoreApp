var productCategoriesController=function(){var u=function(){n();t()},t=function(){$("#btnCreate").off("click").on("click",function(){i();$("#modalAddEdit").modal("show")});$("#frmMaintainance").validate({errorClass:"red",ignore:[],lang:"en",rules:{txtNameProductCategory:{required:!0},txtOrderProductCategory:{number:!0},txtHomeOrderProductCategory:{number:!0}}});$("body").on("click","#btnEdit",function(n){n.preventDefault();var t=$("#hidIdM").val();$.ajax({type:"GET",url:"/Admin/productCategories/GetById",dataType:"json",data:{id:t},beforeSent:function(){app.startLoading()},success:function(n){var t=n;$("#hidIdM").val(t.Id);i(t.categoryId);$("#txtNameProductCategory").val(t.Name);$("#txtDescriptionProductCategory").val(t.Description);$("#txtOrderProductCategory").val(t.SortOrder);$("#txtHomeOrderProductCategory").val(t.HomeOrder);$("#txtSeoPageTitleProductCategory").val(t.SeoPageTitle);$("#txtSeoKeywordsProductCategory").val(t.SeoKeywords);$("#txtSeoDescriptionProductCategory").val(t.SeoDescription);$("#txtSeoAliasProductCategory").val(t.SeoAlias);$("#txtImageProductCategory").val(t.ThumbnailImage);$("#ckStatusProductCategory").prop("checked",t.Status==1);$("#ckShowHomeProductCategory").prop("checked",t.HomeFlag);$("#modalAddEdit").modal("show");app.stopLoading()},error:function(){app.notify("Error","error")}})});$("#btnSave").on("click",function(t){if(t.preventDefault(),$("#frmMaintainance").valid()){var i={id:parseInt($("#hidIdM").val()),name:$("#txtNameProductCategory").val(),parentId:$("#ddlCategoryIdProductCategory").combotree("getValue"),description:$("#txtDescriptionProductCategory").val(),image:$("#txtImageProductCategory").val(),sortOrder:parseInt($("#txtOrderProductCategory").val()),homeOrder:$("#txtHomeOrderProductCategory").val(),seoKeywords:$("#txtSeoKeywordsProductCategory").val(),seoDescription:$("#txtSeoDescriptionProductCategory").val(),seoPageTitle:$("#txtSeoPageTitleProductCategory").val(),seoAlias:$("#txtSeoAliasProductCategory").val(),status:$("#ckStatusProductCategory").prop("checked")==!0?1:0,showHome:$("#ckShowHomeProductCategory").prop("checked")};$.ajax({method:"POST",url:"/admin/productCategories/SaveProductCategory",dataType:"JSON",data:i,beforeSend:function(){app.startLoading()},success:function(){app.notify("Success","success");n(!0);r();app.stopLoading();$("#modalAddEdit").modal("hide")},error:function(){app.notify("Error","error");app.stopLoading()}})}return!1});$("#btnCancel").on("click",function(){$("#modalAddEdit").modal("hide");r()});$("body").on("click","#btnDelete",function(t){t.preventDefault();var i=$("#hidIdM");app.confirm("Are you sure to delete?",function(){$.ajax({type:"POST",url:"/Admin/ProductCategories/DeleteProductCategory",data:{id:that},dataType:"json",beforeSend:function(){app.startLoading()},success:function(){app.notify("Deleted success","success");app.stopLoading();n()},error:function(){app.notify("Has an error in deleting progress","error");app.stopLoading()}})})})},n=function(){var t=$("#table-template").html();$.ajax({type:"GET",url:"/admin/productCategories/GetAll",dataType:"json",success:function(t){var i,r;t&&(i=[],$.each(t,function(n,t){i.push({id:t.Id,text:t.Name,parentId:t.ParentId,sortOrder:t.SortOrder})}),r=app.unflattern(i),r.sort(function(n,t){return n.sortOrder-t.sortOrder}),$("#treeProductCategories").tree({data:r,dnd:!0,onContextMenu:function(n,t){n.preventDefault();$("#tt").tree("select",t.target);$("#hidIdM").val(t.id);$("#contextMenu").menu("show",{left:n.pageX,top:n.pageY})},onDrop:function(t,i,r){var u=$(this).tree("getNode",t),f;r==="append"?(f=[],$.each(u.children,function(n,t){f.push({key:t.id,value:n})}),$.ajax({url:"/Admin/productCategories/UpdateParentId",type:"post",dataType:"json",data:{sourceId:i.id,targetId:u.id,items:f},success:function(){n()}})):(r==="top"||r==="bottom")&&$.ajax({url:"/Admin/productCategories/ReOrder",type:"post",dataType:"json",data:{sourceId:i.id,targetId:u.id},success:function(){n()}})}}))},error:function(n){console.log(n);app.notify("Cannot loading data","error")}})},i=function(n){$.ajax({method:"get",url:"/admin/productCategories/GetAll",dataType:"json",async:!1,success:function(t){var i=[],r;$.each(t,function(n,t){i.push({id:t.Id,text:t.Name,parentId:t.ParentId,sortOrder:t.SortOrder})});r=app.unflattern(i);$("#ddlCategoryIdProductCategory").combotree({data:r});n&&$("#ddlCategoryIdProductCategory").combotree("setValue",n)},error:function(){app.notify("Error","error")}})},r=function(){$("#hidIdM").val(0);$("#txtNameProductCategory").val("");$("#txtDescriptionProductCategory").val("");$("#txtAliasProductCategory").val("");$("#txtOrderProductCategory").val("");$("#txtHomeOrderProductCategory").val("");$("#txtSeoPageTitleProductCategory").val("");$("#txtSeoKeywordsProductCategory").val("");$("#txtSeoDescriptionProductCategory").val("");$("#txtImageProductCategory").val("");$("#txtSeoAliasProductCategory").val("");$("#ckStatusProductCategory").prop("checked",!0);$("#ckShowHomeroductCategory").prop("checked",!1)};return{initailize:u,registerEvent:t}}();